name: PR Slack Notify

on:
  pull_request:
    types: [opened, closed]

jobs:
  notify-slack:
    runs-on: ubuntu-latest
    steps:
      - name: Send Slack notification
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: |
          PR_TITLE="${{ github.event.pull_request.title }}"
          PR_USER="${{ github.event.pull_request.user.login }}"
          PR_URL="${{ github.event.pull_request.html_url }}"
          ACTION="${{ github.event.action }}"

          if [ "$ACTION" == "opened" ]; then
            TEXT="ğŸ†• *ìƒˆ Pull Request ì—´ë¦¼!*\n*ì œëª©:* ${PR_TITLE}\n*ì‘ì„±ì:* ${PR_USER}\n<${PR_URL}|PR ë°”ë¡œê°€ê¸°>"
          elif [ "$ACTION" == "closed" ] && [ "${{ github.event.pull_request.merged }}" == "true" ]; then
            TEXT="âœ… *Pull Request ë¨¸ì§€ë¨!*\n*ì œëª©:* ${PR_TITLE}\n*ë¨¸ì§€í•œ ì‚¬ëŒ:* ${PR_USER}\n<${PR_URL}|PR ë°”ë¡œê°€ê¸°>"
          else
            TEXT="âŒ Pull Requestê°€ ë‹«í˜”ì§€ë§Œ ë¨¸ì§€ë˜ì§„ ì•Šì•˜ì–´ìš”.\n*ì œëª©:* ${PR_TITLE}\n<${PR_URL}|PR ë°”ë¡œê°€ê¸°>"
          fi

          curl -X POST -H 'Content-type: application/json' \
            --data "{\"text\": \"$TEXT\"}" \
            "$SLACK_WEBHOOK_URL"
